<!DOCTYPE html5>
<html>
	<head>
		<title>evaluate-attack-outcome | Holiday Hack 2019</title>
		<link rel="stylesheet" href="/css/common.css">
		<link rel="stylesheet" href="/css/writeup.css">
		<link rel="stylesheet" href="/css/pygments.css">
		<link rel="stylesheet" href="https://unpkg.com/normalize.css@8.0.1/normalize.css">
		
		<meta charset="utf-8" />
	</head>
	<body>
		<main>
			<h1>Windows Log Analysis: Evaluate Attack Outcome</h1>
<p>We can use <a href="https://github.com/williballenthin/python-evtx">python-evtx</a> to dump everything to an XML file, which is much more readable:</p>
<div class="codehilite"><pre><span></span>$ ~/tools/python-evtx/scripts/evtx_dump.py Security.evtx &gt; Security.evtx.xml
</pre></div>


<p>From here we're looking for 4625 (Logon failed) and 4624 (Logon success message). The regex <code>&lt;EventID.*?&gt;4625</code> works and is good enough for scrolling through it in sublime.</p>
<p>We see a pattern of failed logins with LogonType 3 (Network), all to different usernames and with an increasing IpPort number. This is a password spray attack.</p>
<p>We can look for event ids 4624 in a similar way and see a successful login to <code>supatree</code> with LogonType 3. This is the compromised account.</p>
		</main>

		<footer>
			<div class="links">
				<div>
					<a aria-label="Back" href="index.html">
						<span class="iconify" data-icon="fa:arrow-left"></span>
					</a>
				</div>
				<div>
			</div>
		</footer>

		<script src="https://code.iconify.design/1/1.0.3/iconify.min.js"></script>
	</body>
</html>